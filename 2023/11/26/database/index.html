<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="修年">





<title>数据库原理 | 修年</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.4.2"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Xiunian&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Xiunian&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc" style="right: -4em;">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">数据库原理</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">修年</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">十一月 26, 2023&nbsp;&nbsp;15:05:29</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="第一章-绪论"><a href="#第一章-绪论" class="headerlink" title="第一章  绪论"></a>第一章  绪论</h1><p>可以看到，选择题主要考了一下几个概念：</p>
<ol>
<li><p>基于文件系统的管理方法</p>
<p>数据存储于文件中，由应用程序经过文件系统进行管理。</p>
<p>缺点：</p>
<ol>
<li><p>每当文件格式发生变化，就要修改应用程序</p>
</li>
<li><p>文件中存在<strong>冗余</strong>数据</p>
</li>
<li><p>文件修改中可能造成<strong>数据不一致</strong></p>
</li>
<li><p>文件修改可能破坏<strong>数据正确性</strong></p>
</li>
<li><p>没有<strong>索引</strong>，数据访问效率低</p>
</li>
<li><p>只能对<strong>整个文件</strong>进行<strong>访问控制</strong>，数据安全性差【这点确实说得很好】</p>
</li>
<li><p>没有<strong>并发控制</strong>，多个应用程序同时读写文件可能发生冲突</p>
</li>
</ol>
</li>
<li><p>数据库系统包括：数据库、数据库管理系统、数据库应用程序、数据库管理员、计算机与网络基本系统</p>
<p><img src="/2023/11/26/database/image-20231121123536384-1700982197120-1.png" alt="image-20231121123536384"></p>
</li>
<li><p>数据库管理系统：通过数据库语言让用户操作进而提供数据库定义、数据库操纵和数据库控制功能的系统，同时提供了一系列程序能够实现对数据库的各种存储与维护</p>
</li>
<li><p>用户角度，数据库管理系统包括：数据库定义/操纵/控制/维护</p>
</li>
<li><p>模式相关</p>
<p>主要是“三级模式两层映像”结构。</p>
<p>三级模式：</p>
<ol>
<li>用户模式 = 外模式 = 局部模式 =？子模式</li>
<li>概念模式 = 逻辑模式 = 全局模式</li>
<li>物理模式 = 内模式 = 存储模式</li>
</ol>
<p>“模式”默认指概念模式。</p>
<p>两层映像：</p>
<ol>
<li>外模式到概念模式的映像实现了数据的<strong>逻辑独立性</strong></li>
<li>概念模式到内模式的映像实现了数据的<strong>物理独立性</strong></li>
</ol>
<p>数据库系统的数据独立性是指不会因为<u>系统数据存储结构与数据逻辑结构的变化而影响应用程序</u>。</p>
<p><strong>抽象程度：数据模型 &gt; 模式 &gt; 视图【关系模型 - 表结构 - 表数据】</strong></p>
</li>
<li><p>数据模型</p>
<p>重点记各个模型的优缺点。。。</p>
<ol>
<li>层次模型<ol>
<li>优点<ol>
<li>数据结构简单清晰</li>
<li>查询效率高，记录联系指针实现</li>
<li>性能&gt;关系数据库，&lt;=网状数据库</li>
</ol>
</li>
<li>缺点<ol>
<li>现实中很多联系是非层次性的</li>
<li>查询子女必须经过双亲，结构严密，层次命令趋于程序化（这个怎么你了）</li>
</ol>
</li>
</ol>
</li>
<li>网状模型<ol>
<li>优点<ol>
<li>直观</li>
<li>性能好，存取效率高</li>
</ol>
</li>
<li>缺点<ol>
<li>结构复杂</li>
<li>DDL和数据管理语言复杂</li>
<li>应用程序编写困难，联系通过存取路径实现</li>
</ol>
</li>
</ol>
</li>
<li>对象-关系数据库<ol>
<li>可有效支持不满足关系第一范式的数据项</li>
<li>以对象形式封装数据项</li>
<li>行对象与列对象；聚集对象与结构对象</li>
</ol>
</li>
</ol>
</li>
<li><p>发展史</p>
<p>第一代数据库系统是指基于网状模型或层次模型的数据库系统。</p>
<p>第二代数据库系统是指基于关系模型的数据库系统。</p>
</li>
</ol>
<h1 id="第二章-关系代数"><a href="#第二章-关系代数" class="headerlink" title="第二章 关系代数"></a>第二章 关系代数</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><h3 id="关系"><a href="#关系" class="headerlink" title="关系"></a>关系</h3><ol>
<li><p>表/关系，列/属性，行/元组</p>
</li>
<li><p>列的取值范围成为域</p>
<p><img src="/2023/11/26/database/image-20231109195637757.png" alt="image"></p>
</li>
<li><p>元组定义——域的笛卡尔积元素</p>
<p><img src="/2023/11/26/database/image-20231109195437913.png" alt="image"></p>
</li>
<li><p>关系的定义</p>
<p><img src="/2023/11/26/database/image-20231109195514991.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109195613406.png" alt="image"></p>
</li>
<li><p><strong>关系模式相当于表结构，关系就是在表结构的基础上填数据</strong></p>
</li>
<li><p>关系的特性</p>
<p><img src="/2023/11/26/database/image-20231121124828337.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109200020572.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109200035038.png" alt="image"></p>
</li>
<li><p>码</p>
<p><img src="/2023/11/26/database/image-20231109200106492.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109200126332.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109200157646.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109200219924.png" alt="image"></p>
<p>超码：包含候选码的集合</p>
<p><img src="/2023/11/26/database/image-20231109200405923.png" alt="image"></p>
</li>
</ol>
<h3 id="关系模型"><a href="#关系模型" class="headerlink" title="关系模型"></a>关系模型</h3><p><img src="/2023/11/26/database/image-20231109200456953.png" alt="image-20231109200456953"></p>
<h4 id="完整性约束"><a href="#完整性约束" class="headerlink" title="完整性约束"></a>完整性约束</h4><h5 id="实体完整性"><a href="#实体完整性" class="headerlink" title="实体完整性"></a>实体完整性</h5><p>主码不能为空</p>
<h5 id="参照完整性"><a href="#参照完整性" class="headerlink" title="参照完整性"></a>参照完整性</h5><p>外键属性值要么为空，要么为对方的主码值</p>
<h5 id="用户自定义的完整性"><a href="#用户自定义的完整性" class="headerlink" title="用户自定义的完整性"></a>用户自定义的完整性</h5><h2 id="关系代数"><a href="#关系代数" class="headerlink" title="关系代数"></a>关系代数</h2><h3 id="总述"><a href="#总述" class="headerlink" title="总述"></a>总述</h3><p>关系代数结果是一个新的关系。</p>
<p><img src="/2023/11/26/database/image-20231109200834107.png" alt="image"></p>
<h3 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h3><p>集合运算（除了笛卡尔积）需满足<strong>并相容性</strong>。</p>
<p><img src="/2023/11/26/database/image-20231109200953412.png" alt="image"></p>
<h4 id="并"><a href="#并" class="headerlink" title="并"></a>并</h4><p>记得去重</p>
<h4 id="差"><a href="#差" class="headerlink" title="差"></a>差</h4><p>R-S：出现在R中但不在S中</p>
<h4 id="交"><a href="#交" class="headerlink" title="交"></a>交</h4><h4 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h4><p><img src="/2023/11/26/database/image-20231109201241065.png" alt="image"></p>
<h3 id="关系操作"><a href="#关系操作" class="headerlink" title="关系操作"></a>关系操作</h3><h4 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h4><p>选择的是元组</p>
<p><img src="/2023/11/26/database/image-20231109202046281.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109202346027.png" alt="image"></p>
<p>这还能非</p>
<p><img src="/2023/11/26/database/image-20231109202442726.png" alt="image-20231109202442726"></p>
<p>注意且和或的优先级</p>
<h4 id="投影"><a href="#投影" class="headerlink" title="投影"></a>投影</h4><p>选择的是列，记得<strong>去重</strong></p>
<p><img src="/2023/11/26/database/image-20231109202614947.png" alt="image"></p>
<h4 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h4><h5 id="seta-连接"><a href="#seta-连接" class="headerlink" title="seta-连接"></a>seta-连接</h5><p>带条件的</p>
<p><img src="/2023/11/26/database/image-20231109202913382.png" alt="image"></p>
<h5 id="与自身连接"><a href="#与自身连接" class="headerlink" title="与自身连接"></a>与自身连接</h5><p>用ρ更名</p>
<p><img src="/2023/11/26/database/image-20231109203359159.png" alt="image"></p>
<h5 id="等值连接"><a href="#等值连接" class="headerlink" title="等值连接"></a>等值连接</h5><p>还是得带条件，指明要哪两个属性相等</p>
<p><img src="/2023/11/26/database/image-20231109203621403.png" alt="image"></p>
<p>值得注意的是，最后<strong>B和H两列都会保留</strong></p>
<p><img src="/2023/11/26/database/image-20231121130151846.png" alt="image"></p>
<h5 id="自然连接"><a href="#自然连接" class="headerlink" title="自然连接"></a>自然连接</h5><p>值得注意的是，会选取所有相同的<strong>属性组</strong>，<strong>把它们合成同一个属性列</strong>！</p>
<p>【也只有自然连接会做这个合并操作了，别的都是会保留两个列】</p>
<p><img src="/2023/11/26/database/image-20231109203757731.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121130248222.png" alt="image"></p>
<h4 id="除法"><a href="#除法" class="headerlink" title="除法"></a>除法</h4><p>常用于求解“查询全部的/所有的”问题。</p>
<p><strong>R ÷ S = B，B × S的所有元组都在R中。</strong></p>
<p><img src="/2023/11/26/database/image-20231109210237641.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109210440538.png" alt="image"></p>
<p>注意是要每一个元组</p>
<p><img src="/2023/11/26/database/image-20231109211009353.png" alt="image"></p>
<p>除法一般用于带有“全部”“所有”类似字样的题目中</p>
<p><img src="/2023/11/26/database/image-20231121151331409.png" alt="image-20231121151331409"></p>
<p>TODO：抓人对个答案</p>
<p><img src="/2023/11/26/database/IMG_20231121_151752.jpg" alt="image"></p>
<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><p>emmm就是不知道什么时候需要用外连接呢？题目会显式说明吗</p>
<p><img src="/2023/11/26/database/image-20231109215008447.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109215026710.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109215056255.png" alt="image"></p>
<h1 id="第三章-SQL语言"><a href="#第三章-SQL语言" class="headerlink" title="第三章 SQL语言"></a>第三章 SQL语言</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p><img src="/2023/11/26/database/image-20231109220809335.png" alt="image"></p>
<h2 id="SQL语言"><a href="#SQL语言" class="headerlink" title="SQL语言"></a>SQL语言</h2><h3 id="DDL"><a href="#DDL" class="headerlink" title="DDL"></a>DDL</h3><h4 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h4><ol>
<li><p>create database canteen;</p>
</li>
<li><p>create table</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table dish(</span><br><span class="line">   dish_id              int not null,</span><br><span class="line">   dish_intro           varchar(128),</span><br><span class="line">   dish_price           numeric(4,1) not null,</span><br><span class="line">   primary key (dish_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231109220936927.png" alt="image"></p>
<p>这个类型估计得背</p>
<p><img src="/2023/11/26/database/image-20231109221007704.png" alt="image"></p>
</li>
</ol>
<h4 id="撤销与修改"><a href="#撤销与修改" class="headerlink" title="撤销与修改"></a>撤销与修改</h4><ol>
<li><p>drop table student;</p>
</li>
<li><p>alter</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alter table cmt add constraint FK_CMT_ORDER_COM_ORDERS foreign key (order_id)</span><br><span class="line">      references orders (order_id) on delete restrict on update restrict;</span><br><span class="line">      </span><br><span class="line">alter table cmt </span><br><span class="line">      drop foreign key FK_CMT_ORDER_COM_ORDERS;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231111014015615.png" alt="image"></p>
</li>
</ol>
<h3 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h3><h4 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h4><h5 id="基操"><a href="#基操" class="headerlink" title="基操"></a>基操</h5><ol>
<li><p>基操</p>
<p>注意逻辑运算符、运算优先级</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select Tname</span><br><span class="line">from Teacher</span><br><span class="line">where (Salary &lt; 1500 or Salary &gt; 2000) and D# = &#x27;03&#x27;;</span><br></pre></td></tr></table></figure></li>
<li><p>distinct</p>
<p><strong>关系模型的投影和选择结果自动去重</strong>，但是DBMS<strong>允许重复元组</strong>，所以结果<strong>不会</strong>自动去重。</p>
<p>关系的无重复元组<strong>通过主键和唯一性约束保证</strong>，检索结果的无重复元组<strong>通过DISTINCT</strong>保留字保证。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select DISTINCT S#</span><br><span class="line">from SC</span><br><span class="line">where Score &gt; 80;</span><br></pre></td></tr></table></figure></li>
<li><p>order by</p>
<p>通过order by对检索结果降序/升序排序。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select S#, Sname</span><br><span class="line">from Student</span><br><span class="line">Order by S# ASC/DESC;</span><br></pre></td></tr></table></figure></li>
<li><p>like</p>
<p>后接类正则表达式</p>
<p><img src="/2023/11/26/database/image-20231121142004671.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 所有姓张学生</span><br><span class="line">select S#, Sname </span><br><span class="line">from Student</span><br><span class="line">where Sname like &quot;张%&quot;</span><br><span class="line"></span><br><span class="line">-- 所有不姓张学生</span><br><span class="line">select S#, Sname </span><br><span class="line">from Student</span><br><span class="line">where Sname not like &quot;张%&quot;</span><br></pre></td></tr></table></figure></li>
<li><p>多表查询</p>
<p>通过在WHERE中写连接条件来实现。</p>
<p><img src="/2023/11/26/database/image-20231121142256057.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select Sname</span><br><span class="line">from Student (as) stu, SC, Course</span><br><span class="line">where stu.S# = SC.S# and SC.C# = Course.C# and Cname = &#x27;数据库&#x27;</span><br><span class="line">order by Score DESC;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h5><ol>
<li><p>IN</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from student</span><br><span class="line">where Sname in (&quot;张三&quot;, &quot;王三&quot;);</span><br></pre></td></tr></table></figure></li>
</ol>
<p><img src="/2023/11/26/database/image-20231109230840372.png" alt="image"></p>
<ol start="2">
<li><p>相关子查询</p>
<p><img src="/2023/11/26/database/image-20231121144220622.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121144254821.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select Sname from Student S</span><br><span class="line">where `S#` in (</span><br><span class="line">	select `S#` from SC</span><br><span class="line">    where S.S# = SC.S# and `C#` = &#x27;001&#x27;</span><br><span class="line">	);</span><br></pre></td></tr></table></figure></li>
</ol>
<p>可以这么理解，<strong>非相关子查询相当于复杂度On</strong>，先计算出子查询的结果，然后再遍历父查询元组看看是否符合条件；<strong>相关子查询相当于复杂度On方</strong>，需要把父循环变量i代进子循环j中。</p>
<ol start="3">
<li><p>SOME/ALL谓词</p>
<p><img src="/2023/11/26/database/image-20231109231255454.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121144628369.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select Tname from Teacher</span><br><span class="line">where Salary &lt;= all (</span><br><span class="line">	select Salary from Teacher</span><br><span class="line">	);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231109232924888.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109233209020.png" alt="image"></p>
<p>这个确实得注意，一看就很坑爹</p>
</li>
<li><p>exists</p>
<p><img src="/2023/11/26/database/image-20231121145845264.png" alt="image"></p>
<p>意思就是看看子查询结果中有没有元组，有则成立，无则不成立。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select DISTINCT Sname from Student</span><br><span class="line">where exists (</span><br><span class="line">	select * </span><br><span class="line">    from SC, Course, Teacher</span><br><span class="line">    where SC.C# = Course.C# and Course.T# = Teacher.T#</span><br><span class="line">    	and SC.S# = Student.S#	# 这个值得注意！</span><br><span class="line">    	and Teacher.Tname = &quot;李明&quot;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>关系代数的除法模型可以用exists来实现。做出来一题，之后的就可以类比了。</p>
<p><img src="/2023/11/26/database/image-20231109234204566.png" alt="image"></p>
</li>
</ol>
<p><img src="/2023/11/26/database/image-20231109234243468.png" alt="image"></p>
<h5 id="结果计算与聚集函数"><a href="#结果计算与聚集函数" class="headerlink" title="结果计算与聚集函数"></a>结果计算与聚集函数</h5><p><img src="/2023/11/26/database/image-20231121215822395.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select T1.Tname as TR1, T2.Tname as TR2, T1.Salary - T2.Salary as Salary_Diff</span><br><span class="line">from Teacher T1, Teacher T2</span><br><span class="line">where T1.Salary &gt; T2.Salary;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231109234407853.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231109234423901.png" alt="image"></p>
<h5 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h5><h6 id="group-by"><a href="#group-by" class="headerlink" title="group by"></a>group by</h6><p><img src="/2023/11/26/database/image-20231109234509235.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 求每一门课程的平均成绩</span><br><span class="line">select Course.Cname, AVG(Score) as avg_score</span><br><span class="line">from SC, Course</span><br><span class="line">where SC.C# = Course.C#</span><br><span class="line">group by `C#`;</span><br><span class="line"></span><br><span class="line"># 求每一个学生的平均成绩</span><br><span class="line">select `S#`, AVG(Score) as avg_score</span><br><span class="line">from SC</span><br><span class="line">group by `S#`;</span><br></pre></td></tr></table></figure>

<p>使用了group by之后，聚合函数的对象就会自动变成分组，而非整个表了。</p>
<h6 id="having"><a href="#having" class="headerlink" title="having"></a>having</h6><p><img src="/2023/11/26/database/image-20231111012216860.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111012237853.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111012316446.png" alt="image"></p>
<p>可以看到，我们可以对一个group by分组内通过having来使用聚合函数。</p>
<p><img src="/2023/11/26/database/image-20231121220428247.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121220551795.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select `S#`, AVG(Score) from SC</span><br><span class="line">where `S#` in ( # 找出两门以上不及格课程的同学</span><br><span class="line">	select `S#` from SC</span><br><span class="line">    where Score &lt; 60</span><br><span class="line">    group by `S#` having Count(*) &gt; 2</span><br><span class="line">)</span><br><span class="line">group by `S#`; # 才对它求average</span><br></pre></td></tr></table></figure>

<h5 id="并交差"><a href="#并交差" class="headerlink" title="并交差"></a>并交差</h5><p><img src="/2023/11/26/database/image-20231111012533896.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121221445287.png" alt="image"></p>
<h5 id="空值处理"><a href="#空值处理" class="headerlink" title="空值处理"></a>空值处理</h5><p><img src="/2023/11/26/database/image-20231111012929784.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111012955593.png" alt="image"></p>
<h5 id="内连接与外连接"><a href="#内连接与外连接" class="headerlink" title="内连接与外连接"></a>内连接与外连接</h5><p><img src="/2023/11/26/database/image-20231111013032299.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111013154276.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111013347377.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121221816452.png" alt="image-20231121221816452"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from Teacher left outer join Course natural</span><br><span class="line">order by `T#` ASC;</span><br></pre></td></tr></table></figure>



<h4 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h4><p>这几个都是：</p>
<ol>
<li><p>where省略更新所有</p>
</li>
<li><p>不符合用户定义的完整性约束就不执行</p>
<p><img src="/2023/11/26/database/image-20231121222750111.png" alt="image-20231121222750111"></p>
</li>
</ol>
<h5 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h5><p><img src="/2023/11/26/database/image-20231111013525250.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert into Student</span><br><span class="line">values (&#x27;1111&#x27;, &#x27;哈哈&#x27;, &#x27;男&#x27;, 20, &#x27;03&#x27;, &#x27;919324&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231121222615336.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">insert into St</span><br><span class="line">	select `S#`, Sname, AVG(Score)</span><br><span class="line">	from SC, Student</span><br><span class="line">	where SC.S# = Student.S#</span><br><span class="line">	group by Student.`S#`</span><br></pre></td></tr></table></figure>

<h5 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h5><p><img src="/2023/11/26/database/image-20231111013618088.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121222824895.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delete from SC where `S#` = &#x27;34556578&#x27;;</span><br><span class="line"></span><br><span class="line">delete from Student where `D#` in</span><br><span class="line">	(select `D#` from Dept where Dname = &quot;自动控制&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231121223059620.png" alt="image"></p>
<h5 id="update"><a href="#update" class="headerlink" title="update"></a>update</h5><p><img src="/2023/11/26/database/image-20231121223128938.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121223139369.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">update Teacher set Salary = Salary * 1.05;</span><br><span class="line"></span><br><span class="line">update Teacher</span><br><span class="line">set Salary = Salary * 1.1</span><br><span class="line">where `D#` in</span><br><span class="line">	(select `D#` from Dept where Dname = &#x27;计算机&#x27;);</span><br></pre></td></tr></table></figure>

<h5 id="drop"><a href="#drop" class="headerlink" title="drop"></a>drop</h5><p><img src="/2023/11/26/database/image-20231121224230727.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121224345581.png" alt="image"></p>
<h5 id="alter"><a href="#alter" class="headerlink" title="alter"></a>alter</h5><p><img src="/2023/11/26/database/image-20231121224312950.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231121224329749.png" alt="image"></p>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>基本表和视图的概念可以了解一下</p>
<p><img src="/2023/11/26/database/image-20231111014301942.png" alt="image"></p>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p><img src="/2023/11/26/database/image-20231111014355319.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111014424107.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create view CompStud as( 	</span><br><span class="line">    select * from Student</span><br><span class="line">    where `D#` in (select `D#` from dept where Dname = &#x27;计算机&#x27;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create view Teach as(</span><br><span class="line">	select T.Tname, C,Cname, Credit</span><br><span class="line">    from Teacher T, Course C</span><br><span class="line">    where T.T# = C.C#</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231121234202656.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create view StudStat(`S#`, Sname, AvgS, MinS, MaxS, CNT) as (</span><br><span class="line">	select `S#`, Sname, AVG(Score), MIN(Score), MAX(Score), Count(*)</span><br><span class="line">    from Student S, SC where S.S# = SC.S#</span><br><span class="line">    group by S.S#</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/26/database/image-20231121234145286.png" alt="image"></p>
<h4 id="更新-1"><a href="#更新-1" class="headerlink" title="更新"></a>更新</h4><p><img src="/2023/11/26/database/image-20231111014546929.png" alt="image"></p>
<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><p><img src="/2023/11/26/database/image-20231111014613344.png" alt="image"></p>
<h1 id="第四章-数据库的安全性和完整性"><a href="#第四章-数据库的安全性和完整性" class="headerlink" title="第四章 数据库的安全性和完整性"></a>第四章 数据库的安全性和完整性</h1><h2 id="完整性"><a href="#完整性" class="headerlink" title="完整性"></a>完整性</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p>本课程中的完整性指的是语义完整性。</p>
<p><img src="/2023/11/26/database/image-20231111014723556.png" alt="image"></p>
<p><strong>用户定义完整性约束规则保障完整性</strong></p>
<p><img src="/2023/11/26/database/image-20231111014823002.png" alt="image"></p>
<h3 id="完整性约束-1"><a href="#完整性约束-1" class="headerlink" title="完整性约束"></a>完整性约束</h3><p><img src="/2023/11/26/database/image-20231111014855286.png" alt="image"></p>
<h4 id="按约束对象分类"><a href="#按约束对象分类" class="headerlink" title="按约束对象分类"></a>按约束对象分类</h4><ol>
<li><p>域完整性约束</p>
<p><img src="/2023/11/26/database/image-20231122010803741.png" alt="image"></p>
</li>
<li><p>关系完整性约束</p>
<p><img src="/2023/11/26/database/image-20231122010817456.png" alt="image"></p>
</li>
</ol>
<h4 id="按约束来源分类"><a href="#按约束来源分类" class="headerlink" title="按约束来源分类"></a>按约束来源分类</h4><ol>
<li><p>结构约束</p>
<p><img src="/2023/11/26/database/image-20231122010937095.png" alt="image"></p>
</li>
<li><p>内容约束</p>
<p><img src="/2023/11/26/database/image-20231122010950618.png" alt="image"></p>
</li>
</ol>
<h4 id="按约束状态分类"><a href="#按约束状态分类" class="headerlink" title="按约束状态分类"></a>按约束状态分类</h4><ol>
<li><p>静态约束</p>
<p><img src="/2023/11/26/database/image-20231122011109813.png" alt="image"></p>
</li>
<li><p>动态约束</p>
<p><img src="/2023/11/26/database/image-20231122011118787.png" alt="image"></p>
</li>
</ol>
<h3 id="sql中的约束"><a href="#sql中的约束" class="headerlink" title="sql中的约束"></a>sql中的约束</h3><p><img src="/2023/11/26/database/image-20231111015144785.png" alt="image"></p>
<p>触发器是动态约束这个说法真新奇</p>
<h4 id="静态约束"><a href="#静态约束" class="headerlink" title="静态约束"></a>静态约束</h4><p><img src="/2023/11/26/database/image-20231111015324897.png" alt="image"></p>
<h5 id="列约束"><a href="#列约束" class="headerlink" title="列约束"></a>列约束</h5><p><img src="/2023/11/26/database/image-20231111015428210.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111015512202.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table Student(`S#` char(8) not null unique, Sname char(10),</span><br><span class="line">			Ssex char(2) constraint ctssex check(Ssex = &#x27;男&#x27; or Ssex = &#x27;女&#x27;),</span><br><span class="line">            Sage integer check(Sage &gt;= 1 and Sage&lt;150),</span><br><span class="line">            `D#` char(2) references Dept(`D#`) on delete cascade,</span><br><span class="line">            Sclass char(6)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h5 id="表约束"><a href="#表约束" class="headerlink" title="表约束"></a>表约束</h5><p><img src="/2023/11/26/database/image-20231111015614160.png" alt="image"></p>
<p>可以看到，它是在表定义中处于跟属性定义同级的低位。</p>
<p><img src="/2023/11/26/database/image-20231111015703791.png" alt="image"></p>
<h5 id="撤销-追加"><a href="#撤销-追加" class="headerlink" title="撤销/追加"></a>撤销/追加</h5><p><img src="/2023/11/26/database/image-20231111015800368.png" alt="image"></p>
<h4 id="动态约束（触发器）"><a href="#动态约束（触发器）" class="headerlink" title="动态约束（触发器）"></a>动态约束（触发器）</h4><h5 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h5><p>具体的触发器代码写在when里的statement处</p>
<p><img src="/2023/11/26/database/image-20231111020035783.png" alt="image"></p>
<h5 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h5><p><img src="/2023/11/26/database/image-20231111020152266.png" alt="image"></p>
<h2 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h2><p><img src="/2023/11/26/database/image-20231111020344690.png" alt="image"></p>
<h3 id="自主安全性"><a href="#自主安全性" class="headerlink" title="自主安全性"></a>自主安全性</h3><h4 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h4><p><img src="/2023/11/26/database/image-20231111020410876.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111020503479.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111020546406.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111020616230.png" alt="image"></p>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><h5 id="存储矩阵"><a href="#存储矩阵" class="headerlink" title="存储矩阵"></a>存储矩阵</h5><p><img src="/2023/11/26/database/image-20231111020810822.png" alt="image"></p>
<h5 id="视图-1"><a href="#视图-1" class="headerlink" title="视图"></a>视图</h5><p>第二点值得注意，可能意思就是用户A只能读P#为它自己ID的存储，可见存储矩阵。</p>
<p><img src="/2023/11/26/database/image-20231111020846307.png" alt="image"></p>
<h4 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h4><h5 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h5><p><img src="/2023/11/26/database/image-20231111020939917.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122015539538.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122015621305.png" alt="image"></p>
<h5 id="收权"><a href="#收权" class="headerlink" title="收权"></a>收权</h5><p><img src="/2023/11/26/database/image-20231111021113614.png" alt="image"></p>
<h3 id="强制安全性"><a href="#强制安全性" class="headerlink" title="强制安全性"></a>强制安全性</h3><p><img src="/2023/11/26/database/image-20231111192308082.png" alt="image"></p>
<p>反正意思就是说：</p>
<ol>
<li>行列权限冲突，就算是高权限</li>
<li>可以读权限小于等于它的，写权限大于等于它的</li>
</ol>
<p><img src="/2023/11/26/database/image-20231111194055826.png" alt="image"></p>
<p>emmm，也就是说数据的机密性不能降级，只能升级？</p>
<p><img src="/2023/11/26/database/image-20231122015720593.png" alt="image"></p>
<h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><p>为啥这东西归在这里。。。</p>
<p><img src="/2023/11/26/database/image-20231111193132506.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111193207294.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111193224740.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231111193241833.png" alt="image"></p>
<p>66666666666666，这两个例子值得注意</p>
<p><img src="/2023/11/26/database/image-20231111193259298.png" alt="image"></p>
<h1 id="第五章-数据库设计和ER模型"><a href="#第五章-数据库设计和ER模型" class="headerlink" title="第五章 数据库设计和ER模型"></a>第五章 数据库设计和ER模型</h1><p>TODO，这章还没怎么看</p>
<h2 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h2><p><img src="/2023/11/26/database/image-20231113010401041.png" alt="image"></p>
<h2 id="ER模型"><a href="#ER模型" class="headerlink" title="ER模型"></a>ER模型</h2><p><strong>E-R模型：Entity-Relationship Model</strong></p>
<p>草，原来ER是这个意思</p>
<h3 id="实体-联系模型"><a href="#实体-联系模型" class="headerlink" title="实体-联系模型"></a>实体-联系模型</h3><p><img src="/2023/11/26/database/image-20231113010459243.png" alt="image"></p>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><p><img src="/2023/11/26/database/image-20231113010629959.png" alt="image"></p>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><p><img src="/2023/11/26/database/image-20231113010701168.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113010749959.png" alt="image"></p>
<h4 id="码"><a href="#码" class="headerlink" title="码"></a>码</h4><p><img src="/2023/11/26/database/image-20231113010829126.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113010928446.png" alt="image"></p>
<p>蛤，不都是主码主键吗。。。。。。</p>
<h4 id="联系"><a href="#联系" class="headerlink" title="联系"></a>联系</h4><p><img src="/2023/11/26/database/image-20231113011019127.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113011036122.png" alt="image"></p>
<h5 id="一元联系"><a href="#一元联系" class="headerlink" title="一元联系"></a>一元联系</h5><p><img src="/2023/11/26/database/image-20231113011124300.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113011226270.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113011307326.png" alt="image"></p>
<p>我不造啊</p>
<h5 id="二元联系"><a href="#二元联系" class="headerlink" title="二元联系"></a>二元联系</h5><p><img src="/2023/11/26/database/image-20231113011337567.png" alt="image"></p>
<h4 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h4><h5 id="基数"><a href="#基数" class="headerlink" title="基数"></a>基数</h5><p><img src="/2023/11/26/database/image-20231113011423171.png" alt="image"></p>
<h5 id="参与基数"><a href="#参与基数" class="headerlink" title="参与基数"></a>参与基数</h5><p><img src="/2023/11/26/database/image-20231113011827929.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113011931587.png" alt="image"></p>
<h3 id="ER图"><a href="#ER图" class="headerlink" title="ER图"></a>ER图</h3><h4 id="Chen画法"><a href="#Chen画法" class="headerlink" title="Chen画法"></a>Chen画法</h4><p>尼玛，这个总不至于要背吧呃呃，应该大概看懂了差不多得了</p>
<p><img src="/2023/11/26/database/image-20231113012059764.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012200327.png" alt="image"></p>
<p>还是这个比较阳间</p>
<p><img src="/2023/11/26/database/image-20231113012234387.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012326072.png" alt="image"></p>
<p>还要尤其注意这张图，还他妈的不一样。。。</p>
<p><img src="/2023/11/26/database/image-20231113012426565.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012452568.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012505042.png" alt="image"></p>
<p>它那边还有个案例分析，我懒得看了，反正也是忘了。。。</p>
<h4 id="Crow’s-Foot"><a href="#Crow’s-Foot" class="headerlink" title="Crow’s Foot"></a>Crow’s Foot</h4><p>尼玛，这个阳间多了，上面那个是不是因为是中国人才介绍的，乌鱼子</p>
<p><img src="/2023/11/26/database/image-20231113012612518.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012726559.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012712524.png" alt="image"></p>
<p>1就是竖线，0就是圈圈，多就是开叉</p>
<p><img src="/2023/11/26/database/image-20231113012736223.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012849587.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113012920654.png" alt="image"></p>
<p>也挺好理解，那边有个圈圈代表0</p>
<p><img src="/2023/11/26/database/image-20231113013000789.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113013045058.png" alt="image"></p>
<h3 id="ER图-gt-关系模式"><a href="#ER图-gt-关系模式" class="headerlink" title="ER图-&gt;关系模式"></a>ER图-&gt;关系模式</h3><p><img src="/2023/11/26/database/image-20231113013124582.png" alt="image"></p>
<h4 id="属性的转换"><a href="#属性的转换" class="headerlink" title="属性的转换"></a>属性的转换</h4><p><img src="/2023/11/26/database/image-20231113013154673.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113013226139.png" alt="image"></p>
<p>oh！原来是这样，确实这样减少了冗余</p>
<h4 id="联系的转换"><a href="#联系的转换" class="headerlink" title="联系的转换"></a>联系的转换</h4><p><img src="/2023/11/26/database/image-20231113013337455.png" alt="image"></p>
<p>确实也避免了大量空值，不过如果双方均部分参与，新关系是不是还得再多一列什么序号作为关键字？还是一个为空直接啥了，不大懂啊</p>
<p><img src="/2023/11/26/database/image-20231113013435709.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113013515583.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113013756973.png" alt="image"></p>
<h4 id="弱实体"><a href="#弱实体" class="headerlink" title="弱实体"></a>弱实体</h4><p><img src="/2023/11/26/database/image-20231113013849488.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113013956590.png" alt="image"></p>
<p>也就是说弱实体虽然有键，但是不够作为主键？什么鬼</p>
<p>这个箭头可以看出，弱实体完全参与联系，且为1:m关系。</p>
<h4 id="具化-泛化"><a href="#具化-泛化" class="headerlink" title="具化/泛化"></a>具化/泛化</h4><p><img src="/2023/11/26/database/image-20231113014230792.png" alt="image"></p>
<p>这个的意思就是person是对customer和employee的泛化，customer和employee是对person的具化。</p>
<h3 id="实体联系设计问题"><a href="#实体联系设计问题" class="headerlink" title="实体联系设计问题"></a>实体联系设计问题</h3><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><h5 id="冗余"><a href="#冗余" class="headerlink" title="冗余"></a>冗余</h5><p><img src="/2023/11/26/database/image-20231113014350739.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113014404705.png" alt="image"></p>
<h5 id="删除异常"><a href="#删除异常" class="headerlink" title="删除异常"></a>删除异常</h5><p><img src="/2023/11/26/database/image-20231113014444491.png" alt="image"></p>
<h4 id="设计准则"><a href="#设计准则" class="headerlink" title="设计准则"></a>设计准则</h4><p><img src="/2023/11/26/database/image-20231113014524064.png" alt="image"></p>
<h2 id="物理数据库"><a href="#物理数据库" class="headerlink" title="物理数据库"></a>物理数据库</h2><p><img src="/2023/11/26/database/image-20231113014638476.png" alt="image"></p>
<h1 id="第六章-数据库规范"><a href="#第六章-数据库规范" class="headerlink" title="第六章  数据库规范"></a>第六章  数据库规范</h1><h2 id="函数依赖"><a href="#函数依赖" class="headerlink" title="函数依赖"></a>函数依赖</h2><h3 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h3><h4 id="函数依赖-1"><a href="#函数依赖-1" class="headerlink" title="函数依赖"></a>函数依赖</h4><h5 id="定义-3"><a href="#定义-3" class="headerlink" title="定义"></a>定义</h5><p><img src="/2023/11/26/database/image-20231113211856809.png" alt="image"></p>
<h5 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h5><p><img src="/2023/11/26/database/image-20231113212058941.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113212140731.png" alt="image"></p>
<h4 id="部分-完全-传递依赖"><a href="#部分-完全-传递依赖" class="headerlink" title="部分/完全/传递依赖"></a>部分/完全/传递依赖</h4><h5 id="部分-完全"><a href="#部分-完全" class="headerlink" title="部分/完全"></a>部分/完全</h5><p><img src="/2023/11/26/database/image-20231113212231783.png" alt="image"></p>
<h5 id="传递"><a href="#传递" class="headerlink" title="传递"></a>传递</h5><p><img src="/2023/11/26/database/image-20231113212333058.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113212420802.png" alt="image"></p>
<h4 id="候选码"><a href="#候选码" class="headerlink" title="候选码"></a>候选码</h4><p><img src="/2023/11/26/database/image-20231113212459348.png" alt="image"></p>
<p>注意必须得是<strong>完全依赖</strong>，也就是说要满足<strong>极小性</strong>。</p>
<h2 id="公理系统"><a href="#公理系统" class="headerlink" title="公理系统"></a>公理系统</h2><h3 id="定义-4"><a href="#定义-4" class="headerlink" title="定义"></a>定义</h3><h4 id="逻辑蕴含"><a href="#逻辑蕴含" class="headerlink" title="逻辑蕴含"></a>逻辑蕴含</h4><p><img src="/2023/11/26/database/image-20231113212630097.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113212726856.png" alt="image"></p>
<h3 id="公理、定理"><a href="#公理、定理" class="headerlink" title="公理、定理"></a>公理、定理</h3><p><img src="/2023/11/26/database/image-20231113212849611.png" alt="image"></p>
<p>注意看我加的黑字批注。</p>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>从而由此可以定义某个属性/属性组的闭包：</p>
<p><img src="/2023/11/26/database/image-20231113213213906.png" alt="image"></p>
<p>也即存放的是通过这个什么定理，从X开始可以导出的所有属性。</p>
<p><img src="/2023/11/26/database/image-20231113214310299.png" alt="image"></p>
<p>TODO，这个没懂</p>
<p>好像意思就是，如果F的闭包等于自身，那么它就是一个全函数依赖族。可以联想一下什么情况会闭包等于自身呢？感觉差不多就是消除了所有的传递依赖之类的。</p>
<p><img src="/2023/11/26/database/image-20231113214519838.png" alt="image"></p>
<h3 id="函数依赖集"><a href="#函数依赖集" class="headerlink" title="函数依赖集"></a>函数依赖集</h3><p>如果两个函数依赖的函数依赖完备集等价，则两个函数依赖等价。</p>
<p><img src="/2023/11/26/database/image-20231113214540305.png" alt="image"></p>
<h4 id="覆盖"><a href="#覆盖" class="headerlink" title="覆盖"></a>覆盖</h4><p><img src="/2023/11/26/database/image-20231113214602249.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113214841795.png" alt="image"></p>
<p>这个最小函数依赖注意一下，反正意思就是右边就一个，然后木有冗余依赖和冗余属性。</p>
<p><img src="/2023/11/26/database/image-20231113215013715.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122153306160.png" alt="image"></p>
<h2 id="范式"><a href="#范式" class="headerlink" title="范式"></a>范式</h2><p><img src="/2023/11/26/database/image-20231122153909431.png" alt="image"></p>
<h3 id="1NF"><a href="#1NF" class="headerlink" title="1NF"></a>1NF</h3><p><img src="/2023/11/26/database/image-20231113215054699.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113215118293.png" alt="image"></p>
<h3 id="2NF"><a href="#2NF" class="headerlink" title="2NF"></a>2NF</h3><p><img src="/2023/11/26/database/image-20231113215147245.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113215200534.png" alt="image"></p>
<h3 id="3NF"><a href="#3NF" class="headerlink" title="3NF"></a>3NF</h3><p><img src="/2023/11/26/database/image-20231113215241582.png" alt="image"></p>
<p>消除了非主属性对主属性的传递依赖。</p>
<p>也就是说，最后的情况就是非主属性完全且非传递依赖于主属性</p>
<h3 id="BCNF"><a href="#BCNF" class="headerlink" title="BCNF"></a>BCNF</h3><p><img src="/2023/11/26/database/image-20231113215556843.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113215721769.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122153643590.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122153705584.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122153839955.png" alt="image"></p>
<h2 id="模式分解"><a href="#模式分解" class="headerlink" title="模式分解"></a>模式分解</h2><p><img src="/2023/11/26/database/image-20231113223249688.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231113223400726.png" alt="image"></p>
<p>沙比，说得那么曲折，反正意思就是，ρ是一个模式分解，然后如果对ρ里面每个属性进行投影，最后把这些结果连接起来，最后的东西就叫做这个mr，也即投影连接。【就是这个连接不知道是笛卡尔积还是什么玩意】</p>
<p><img src="/2023/11/26/database/image-20231113223851503.png" alt="image"></p>
<h3 id="无损连接分解"><a href="#无损连接分解" class="headerlink" title="无损连接分解"></a>无损连接分解</h3><p><img src="/2023/11/26/database/image-20231113223925420.png" alt="image"></p>
<h4 id="判断方法"><a href="#判断方法" class="headerlink" title="判断方法"></a>判断方法</h4><h4 id="无损分解BCNF"><a href="#无损分解BCNF" class="headerlink" title="无损分解BCNF"></a>无损分解BCNF</h4><h3 id="保持依赖分解"><a href="#保持依赖分解" class="headerlink" title="保持依赖分解"></a>保持依赖分解</h3><p><img src="/2023/11/26/database/image-20231113224430739.png" alt="image"></p>
<p>反正意思就是，F中的左部右部都在Ri这个属性的，这些式子能推导出F中其他式子，那么就叫保持依赖。</p>
<h4 id="判断方法-1"><a href="#判断方法-1" class="headerlink" title="判断方法"></a>判断方法</h4><h4 id="保持依赖分解3NF"><a href="#保持依赖分解3NF" class="headerlink" title="保持依赖分解3NF"></a>保持依赖分解3NF</h4><h4 id="又无损又保持依赖"><a href="#又无损又保持依赖" class="headerlink" title="又无损又保持依赖"></a>又无损又保持依赖</h4><h1 id="第七章-数据库物理存储"><a href="#第七章-数据库物理存储" class="headerlink" title="第七章  数据库物理存储"></a>第七章  数据库物理存储</h1><h2 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h2><h3 id="存储体系"><a href="#存储体系" class="headerlink" title="存储体系"></a>存储体系</h3><p><img src="/2023/11/26/database/image-20231115132944815.png" alt="image"></p>
<h3 id="磁盘结构"><a href="#磁盘结构" class="headerlink" title="磁盘结构"></a>磁盘结构</h3><h4 id="容量"><a href="#容量" class="headerlink" title="容量"></a>容量</h4><p><img src="/2023/11/26/database/image-20231115133555203.png" alt="image"></p>
<p>圆盘-盘面-磁道-扇区</p>
<p><img src="/2023/11/26/database/image-20231115133655340.png" alt="image"></p>
<p>这个例子值得注意，<strong>不论一个文件多小，它都是占一个磁盘块</strong>。</p>
<p>一般情况下，一个磁盘块包含多个扇区。</p>
<h4 id="读写时间"><a href="#读写时间" class="headerlink" title="读写时间"></a>读写时间</h4><p><img src="/2023/11/26/database/image-20231115133929771.png" alt="image"></p>
<h4 id="RAID"><a href="#RAID" class="headerlink" title="RAID"></a>RAID</h4><p><img src="/2023/11/26/database/image-20231115134119332.png" alt="image"></p>
<h2 id="数据库实现"><a href="#数据库实现" class="headerlink" title="数据库实现"></a>数据库实现</h2><h3 id="存储查询实现"><a href="#存储查询实现" class="headerlink" title="存储查询实现"></a>存储查询实现</h3><p><img src="/2023/11/26/database/image-20231115134323356.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115134454134.png" alt="image"></p>
<p>真感觉有必要写一下cmu15445</p>
<h3 id="与磁盘映射"><a href="#与磁盘映射" class="headerlink" title="与磁盘映射"></a>与磁盘映射</h3><p><img src="/2023/11/26/database/image-20231115134602408.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115134655136.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115134827256.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115134925277.png" alt="image"></p>
<h3 id="文件组织方法"><a href="#文件组织方法" class="headerlink" title="文件组织方法"></a>文件组织方法</h3><p><img src="/2023/11/26/database/image-20231115135034520.png" alt="image"></p>
<h4 id="无序"><a href="#无序" class="headerlink" title="无序"></a>无序</h4><p><img src="/2023/11/26/database/image-20231115135058681.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115135157120.png" alt="image"></p>
<h4 id="有序"><a href="#有序" class="headerlink" title="有序"></a>有序</h4><p><img src="/2023/11/26/database/image-20231115135315193.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115135345701.png" alt="image"></p>
<p>你也要GC是吧</p>
<h4 id="散列"><a href="#散列" class="headerlink" title="散列"></a>散列</h4><p><img src="/2023/11/26/database/image-20231115135428682.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115135521383.png" alt="image"></p>
<h4 id="聚簇文件"><a href="#聚簇文件" class="headerlink" title="聚簇文件"></a>聚簇文件</h4><p><img src="/2023/11/26/database/image-20231115135620701.png" alt="image"></p>
<h1 id="第八章-数据库索引"><a href="#第八章-数据库索引" class="headerlink" title="第八章  数据库索引"></a>第八章  数据库索引</h1><h2 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h2><h3 id="定义-5"><a href="#定义-5" class="headerlink" title="定义"></a>定义</h3><p><img src="/2023/11/26/database/image-20231115135854375.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115135930380.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115140030138.png" alt="image"></p>
<h3 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h3><p><img src="/2023/11/26/database/image-20231115140225181.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115140257842.png" alt="image"></p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>总之总结一下，其实大概就是稀疏索引和稠密索引。</p>
<p>然后：</p>
<ol>
<li><p>根据<strong>主属性</strong>排序的主文件+稀疏索引 = 主索引</p>
</li>
<li><p>根据<strong>某个属性</strong>排序的主文件+稀疏/稠密索引 = 聚簇索引【可以注意下跟主索引的差别】</p>
<p><img src="/2023/11/26/database/image-20231122204416032.png" alt="image"></p>
</li>
<li><p>根据<strong>非主属性</strong>排序的主文件+稠密索引 = 辅助索引</p>
</li>
<li><p>对某个非排序属性进行稠密索引 = 非聚簇索引</p>
</li>
</ol>
<p><img src="/2023/11/26/database/image-20231115141956215.png" alt="image-20231115141956215"></p>
<h3 id="稀疏与稠密"><a href="#稀疏与稠密" class="headerlink" title="稀疏与稠密"></a>稀疏与稠密</h3><p><img src="/2023/11/26/database/image-20231115140404429.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115140515180.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115140604736.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115140638660.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115140708009.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115140722861.png" alt="image"></p>
<p>还得是折中，加层</p>
<h3 id="主-辅助索引"><a href="#主-辅助索引" class="headerlink" title="主/辅助索引"></a>主/辅助索引</h3><p>这个就是我们dblab5干的</p>
<p><img src="/2023/11/26/database/image-20231115140928530.png" alt="image"></p>
<p>注意，它确实就引入了个链表，关注Downtown字段。</p>
<p><img src="/2023/11/26/database/image-20231115141010417.png" alt="image"></p>
<p>不用排序是因为相当于加了一层哈希了。</p>
<p><img src="/2023/11/26/database/image-20231115141331158.png" alt="image"></p>
<p>TODO，说实话那句话真没看懂</p>
<h3 id="聚簇-非聚簇"><a href="#聚簇-非聚簇" class="headerlink" title="聚簇/非聚簇"></a>聚簇/非聚簇</h3><p><img src="/2023/11/26/database/image-20231115141418904.png" alt="image"></p>
<p>上面那个是稀疏索引，相当于不是根据主码而是根据别的属性了</p>
<p><img src="/2023/11/26/database/image-20231115141910100.png" alt="image"></p>
<p>与主索引差别：</p>
<p><img src="/2023/11/26/database/image-20231115141922272.png" alt="image-20231115141922272"></p>
<p><img src="/2023/11/26/database/image-20231115141948107.png" alt="image"></p>
<h3 id="倒排索引"><a href="#倒排索引" class="headerlink" title="倒排索引"></a>倒排索引</h3><p><img src="/2023/11/26/database/image-20231115142026440.png" alt="image"></p>
<p>这个算不算content-based hhh</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p><img src="/2023/11/26/database/image-20231115142120497.png" alt="image"></p>
<h2 id="B-树"><a href="#B-树" class="headerlink" title="B+树"></a>B+树</h2><p>TODO</p>
<h3 id="存储约定"><a href="#存储约定" class="headerlink" title="存储约定"></a>存储约定</h3><p><img src="/2023/11/26/database/image-20231115142159191.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115142217001.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115172301194.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115172425562.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115172510107.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115172532333.png" alt="image"></p>
<h3 id="建立不同索引"><a href="#建立不同索引" class="headerlink" title="建立不同索引"></a>建立不同索引</h3><h4 id="主键稠密"><a href="#主键稠密" class="headerlink" title="主键稠密"></a>主键稠密</h4><p><img src="/2023/11/26/database/image-20231115172830947.png" alt="image"></p>
<h4 id="主键稀疏"><a href="#主键稀疏" class="headerlink" title="主键稀疏"></a>主键稀疏</h4><p><img src="/2023/11/26/database/image-20231115172906059.png" alt="image"></p>
<h4 id="非键稠密"><a href="#非键稠密" class="headerlink" title="非键稠密"></a>非键稠密</h4><h5 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h5><p><img src="/2023/11/26/database/image-20231115173121363.png" alt="image"></p>
<h5 id="不排序"><a href="#不排序" class="headerlink" title="不排序"></a>不排序</h5><p><img src="/2023/11/26/database/image-20231115173136033.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231115173207528.png" alt="image"></p>
<h3 id="B树"><a href="#B树" class="headerlink" title="B树"></a>B树</h3><p><img src="/2023/11/26/database/image-20231115173603230.png" alt="image"></p>
<h3 id="插入删除"><a href="#插入删除" class="headerlink" title="插入删除"></a>插入删除</h3><p><img src="/2023/11/26/database/image-20231115173820682.png" alt="image"></p>
<p>这些就结合下cmu的跟ppt的算法复习一下吧，考前再说。</p>
<h2 id="散列-1"><a href="#散列-1" class="headerlink" title="散列"></a>散列</h2><h3 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h3><p><img src="/2023/11/26/database/image-20231116010611468.png" alt="image"></p>
<h3 id="散列索引"><a href="#散列索引" class="headerlink" title="散列索引"></a>散列索引</h3><p><img src="/2023/11/26/database/image-20231116010731538.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116010749789.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116010831995.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116010856907.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116010934162.png" alt="image"></p>
<h3 id="动态散列索引"><a href="#动态散列索引" class="headerlink" title="动态散列索引"></a>动态散列索引</h3><p><img src="/2023/11/26/database/image-20231122212544718.png" alt="image"></p>
<h4 id="可扩展散列索引"><a href="#可扩展散列索引" class="headerlink" title="可扩展散列索引"></a>可扩展散列索引</h4><p><img src="/2023/11/26/database/image-20231116011209676.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116011419364.png" alt="image"></p>
<p>注意，<strong>其它不变</strong>，每次只需重新散列涉及到的那个桶。此时00和01两个桶还是指向的0010这个快。</p>
<p><img src="/2023/11/26/database/image-20231116011505704.png" alt="image"></p>
<p>这时候i无需增加</p>
<p><img src="/2023/11/26/database/image-20231116011552196.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116011608595.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116011645585.png" alt="image"></p>
<h4 id="线性散列索引"><a href="#线性散列索引" class="headerlink" title="线性散列索引"></a>线性散列索引</h4><p><img src="/2023/11/26/database/image-20231116011904472.png" alt="image"></p>
<p>它这个意思应该是mask有log2n位，也即hash函数为k &amp; (2^log2n - 1)</p>
<p><img src="/2023/11/26/database/image-20231116012244325.png" alt="image"></p>
<p>也即把最高位改为0.</p>
<p><img src="/2023/11/26/database/image-20231116012302912.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116012316867.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116012333634.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116012347681.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116012400882.png" alt="image"></p>
<h1 id="第九章-数据库查询算法实现"><a href="#第九章-数据库查询算法实现" class="headerlink" title="第九章  数据库查询算法实现"></a>第九章  数据库查询算法实现</h1><h2 id="连接的实现"><a href="#连接的实现" class="headerlink" title="连接的实现"></a>连接的实现</h2><p><img src="/2023/11/26/database/image-20231122223551840.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116012707470.png" alt="image"></p>
<p>注意，主存每页容量等于一个磁盘块容量，此处做了简化感觉。</p>
<p><img src="/2023/11/26/database/image-20231116012743745.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116012826999.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116013059644.png" alt="image"></p>
<h2 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h2><p>用于一元操作</p>
<p><img src="/2023/11/26/database/image-20231122223740337.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122223825605.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231122223906478.png" alt="image"></p>
<h2 id="一趟扫描算法"><a href="#一趟扫描算法" class="headerlink" title="一趟扫描算法"></a>一趟扫描算法</h2><p><img src="/2023/11/26/database/image-20231116012640064.png" alt="image"></p>
<h3 id="一趟扫描"><a href="#一趟扫描" class="headerlink" title="一趟扫描"></a>一趟扫描</h3><p>没看懂</p>
<p><img src="/2023/11/26/database/image-20231116013431764.png" alt="image"></p>
<h3 id="基于索引"><a href="#基于索引" class="headerlink" title="基于索引"></a>基于索引</h3><p><img src="/2023/11/26/database/image-20231116013511895.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116013541689.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116013601971.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231116013618237.png" alt="image"></p>
<h2 id="两趟扫描"><a href="#两趟扫描" class="headerlink" title="两趟扫描"></a>两趟扫描</h2><h3 id="内外排序"><a href="#内外排序" class="headerlink" title="内外排序"></a>内外排序</h3><p><img src="/2023/11/26/database/image-20231119012808663.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119012834989.png" alt="image"></p>
<h3 id="两阶段多路归并排序TPMMS"><a href="#两阶段多路归并排序TPMMS" class="headerlink" title="两阶段多路归并排序TPMMS"></a>两阶段多路归并排序TPMMS</h3><p><img src="/2023/11/26/database/image-20231119012927069.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119012951384.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119013038924.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119013130221.png" alt="image"></p>
<p>干净一点的图：</p>
<p><img src="/2023/11/26/database/image-20231119013233922.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119013337946.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119013413380.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119013444525.png" alt="image"></p>
<p>可以画个树理解一下</p>
<h1 id="第十章-数据库查询优化技术"><a href="#第十章-数据库查询优化技术" class="headerlink" title="第十章  数据库查询优化技术"></a>第十章  数据库查询优化技术</h1><h2 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h2><p><img src="/2023/11/26/database/image-20231119013805179.png" alt="image"></p>
<h2 id="优化思路"><a href="#优化思路" class="headerlink" title="优化思路"></a>优化思路</h2><p><img src="/2023/11/26/database/image-20231119013920839.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119014421415.png" alt="image"></p>
<h3 id="语义优化"><a href="#语义优化" class="headerlink" title="语义优化"></a>语义优化</h3><p>也就是SQL语句层面的优化</p>
<p><img src="/2023/11/26/database/image-20231119014020926.png" alt="image"></p>
<h3 id="语法优化"><a href="#语法优化" class="headerlink" title="语法优化"></a>语法优化</h3><p>也就是关系运算层面的优化</p>
<p><img src="/2023/11/26/database/image-20231119014108270.png" alt="image"></p>
<p>6</p>
<p><img src="/2023/11/26/database/image-20231119014334329.png" alt="image"></p>
<h2 id="语法优化（逻辑层优化）"><a href="#语法优化（逻辑层优化）" class="headerlink" title="语法优化（逻辑层优化）"></a>语法优化（逻辑层优化）</h2><h3 id="示例背景"><a href="#示例背景" class="headerlink" title="示例背景"></a>示例背景</h3><p><img src="/2023/11/26/database/image-20231119014551414.png" alt="image"></p>
<h3 id="语法树"><a href="#语法树" class="headerlink" title="语法树"></a>语法树</h3><p><img src="/2023/11/26/database/image-20231119014849382.png" alt="image"></p>
<p>这个就相当于把XLOANS这个视图定义展开为语法树了</p>
<h3 id="优化策略"><a href="#优化策略" class="headerlink" title="优化策略"></a>优化策略</h3><p><img src="/2023/11/26/database/image-20231119015111213.png" alt="image"></p>
<p>人话：</p>
<ol>
<li>早做投影和选择</li>
<li>选择投影尽量挨在一起</li>
<li>没懂。。。</li>
<li>选择+笛卡尔积换成条件连接</li>
<li>预处理，如建立索引</li>
<li>找公共子表达式（如语法图）</li>
</ol>
<p><img src="/2023/11/26/database/image-20231119015334132.png" alt="image"></p>
<p>我服了，体会一下吧。</p>
<h2 id="关系代数操作次序交换的等价性"><a href="#关系代数操作次序交换的等价性" class="headerlink" title="关系代数操作次序交换的等价性"></a>关系代数操作次序交换的等价性</h2><h3 id="定义-6"><a href="#定义-6" class="headerlink" title="定义"></a>定义</h3><p><img src="/2023/11/26/database/image-20231119015421114.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119015501977.png" alt="image"></p>
<h3 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h3><p><img src="/2023/11/26/database/image-20231119015636537.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119015742343.png" alt="image"></p>
<p>意思就是这个l3可以用来：</p>
<ol>
<li>两遍扫描-&gt;一遍扫描</li>
<li>拓展语法树，便于用之后其它定理化简</li>
</ol>
<p><img src="/2023/11/26/database/image-20231119020008946.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119020046524.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119020217677.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119020334738.png" alt="image"></p>
<p>这个也体现了，反向使用定理L3，然后再用L7这个组合技达到的优化效果</p>
<p><img src="/2023/11/26/database/image-20231119020537578.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119020720230.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119020808244.png" alt="image"></p>
<p>注意，投影和差是<strong>没有</strong>交换律的。</p>
<p>虽然都确实直观吧，但我感觉我服了。。。</p>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><p>TODO</p>
<p>这个具体看PPT吧，还有它后面的例子，或者听下网课，感觉快死了。</p>
<p><img src="/2023/11/26/database/image-20231119020856546.png" alt="image"></p>
<h2 id="物理查询优化"><a href="#物理查询优化" class="headerlink" title="物理查询优化"></a>物理查询优化</h2><h3 id="定义-7"><a href="#定义-7" class="headerlink" title="定义"></a>定义</h3><p><img src="/2023/11/26/database/image-20231119021044424.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119021145310.png" alt="image"></p>
<p>TODO，为啥非聚簇，用索引就得每个元组扫一遍？？？不是取决于索引表大小吗，我真服了</p>
<h3 id="算法思路"><a href="#算法思路" class="headerlink" title="算法思路"></a>算法思路</h3><p><img src="/2023/11/26/database/image-20231119021321176.png" alt="image"></p>
<h3 id="性能评估"><a href="#性能评估" class="headerlink" title="性能评估"></a>性能评估</h3><h4 id="评估方案"><a href="#评估方案" class="headerlink" title="评估方案"></a>评估方案</h4><p><img src="/2023/11/26/database/image-20231119150057910.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119152230253.png" alt="image"></p>
<h4 id="数据获取"><a href="#数据获取" class="headerlink" title="数据获取"></a>数据获取</h4><p><img src="/2023/11/26/database/image-20231119152401771.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119152423660.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119152439551.png" alt="image"></p>
<h4 id="代价估算"><a href="#代价估算" class="headerlink" title="代价估算"></a>代价估算</h4><p><img src="/2023/11/26/database/image-20231119152546619.png" alt="image"></p>
<h5 id="投影-1"><a href="#投影-1" class="headerlink" title="投影"></a>投影</h5><p><img src="/2023/11/26/database/image-20231119152859873.png" alt="image"></p>
<h5 id="选择-1"><a href="#选择-1" class="headerlink" title="选择"></a>选择</h5><p><img src="/2023/11/26/database/image-20231119153300067.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119153440102.png" alt="image"></p>
<p>好吧，m和n也是这么估算的：</p>
<p><img src="/2023/11/26/database/image-20231119153527373.png" alt="image"></p>
<p>最后那个简单估计，是意思是复杂度主要由第二个条件决定吗？想想确实很直观。</p>
<h5 id="连接-1"><a href="#连接-1" class="headerlink" title="连接"></a>连接</h5><p><img src="/2023/11/26/database/image-20231119154954477.png" alt="image"></p>
<h5 id="简要结论"><a href="#简要结论" class="headerlink" title="简要结论"></a>简要结论</h5><p><img src="/2023/11/26/database/image-20231119155035281.png" alt="image"></p>
<h1 id="第十一章-数据库事务处理技术"><a href="#第十一章-数据库事务处理技术" class="headerlink" title="第十一章  数据库事务处理技术"></a>第十一章  数据库事务处理技术</h1><p>反正大概意思就是：</p>
<p><img src="/2023/11/26/database/image-20231119182623273.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119182635136.png" alt="image"></p>
<p>本章就是围绕这两个问题来的。</p>
<h2 id="不一致现象"><a href="#不一致现象" class="headerlink" title="不一致现象"></a>不一致现象</h2><p><img src="/2023/11/26/database/image-20231119155331420.png" alt="image"></p>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><h3 id="定义-8"><a href="#定义-8" class="headerlink" title="定义"></a>定义</h3><p><img src="/2023/11/26/database/image-20231119155547636.png" alt="image"></p>
<h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p><img src="/2023/11/26/database/image-20231119160029653.png" alt="image"></p>
<h4 id="宏观性"><a href="#宏观性" class="headerlink" title="宏观性"></a>宏观性</h4><p><img src="/2023/11/26/database/image-20231119155848115.png" alt="image"></p>
<h4 id="微观性"><a href="#微观性" class="headerlink" title="微观性"></a>微观性</h4><p><img src="/2023/11/26/database/image-20231119160001927.png" alt="image"></p>
<h3 id="特性：ACID"><a href="#特性：ACID" class="headerlink" title="特性：ACID"></a>特性：ACID</h3><p><img src="/2023/11/26/database/image-20231119160134524.png" alt="image"></p>
<h3 id="调度与可串行性"><a href="#调度与可串行性" class="headerlink" title="调度与可串行性"></a>调度与可串行性</h3><h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h4><p><img src="/2023/11/26/database/image-20231119160217938.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119160233528.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119160252158.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119160636318.png" alt="image"></p>
<p>图中最右错误，是因为这样的话B=B-20这个操作事实上就会被覆盖了。这两个事务不关心读的是不是B origin，只需要+10和-20操作都做了就行。</p>
<h4 id="事务模型"><a href="#事务模型" class="headerlink" title="事务模型"></a>事务模型</h4><p><img src="/2023/11/26/database/image-20231119181536555.png" alt="image"></p>
<h4 id="冲突与可串行性"><a href="#冲突与可串行性" class="headerlink" title="冲突与可串行性"></a>冲突与可串行性</h4><blockquote>
<p>强烈推荐：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/516557516">冲突可串行化、事务优先图</a>。PPT讲的不知道啥玩意</p>
</blockquote>
<blockquote>
<p>也就是说，如果一个schedule经过一系列对任意两个不冲突操作的调换动作后，可以变成一个完全串行的schedule，那么我们就称其为冲突可串行化。</p>
</blockquote>
<p><img src="/2023/11/26/database/image-20231119181654164.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119181749410.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119184216295.png" alt="image-20231119184216295"></p>
<p><img src="/2023/11/26/database/image-20231119184114564.png" alt="image-20231119184114564"></p>
<p><img src="/2023/11/26/database/v2-5a263633d1f4259956ad533927d0da75_1440w.webp" alt="image"></p>
<p>如果一个 schedule 和某个串行 schedule 冲突等价，则称该 schedule 是<strong>冲突可串行化（conflict serializable）</strong>的。</p>
<p><img src="/2023/11/26/database/image-20231119184602488.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119181901614.png" alt="image"></p>
<p>真不懂</p>
<p><img src="/2023/11/26/database/image-20231119181923979.png" alt="image"></p>
<h2 id="冲突可串行判别算法"><a href="#冲突可串行判别算法" class="headerlink" title="冲突可串行判别算法"></a>冲突可串行判别算法</h2><p><img src="/2023/11/26/database/image-20231119190122097.png" alt="image"></p>
<p>一种就是上面那个图片例子，一直交换直到得到串行调度；</p>
<p>另一种就是下面要介绍的这个画图了。</p>
<p>说实话真没懂这啥玩意冲突可串行</p>
<p><img src="/2023/11/26/database/image-20231119182129408.png" alt="image"></p>
<p>也没搞懂这灰线又tm哪来的。。。</p>
<p><img src="/2023/11/26/database/image-20231119182448346.png" alt="image"></p>
<h2 id="基于封锁的并发控制"><a href="#基于封锁的并发控制" class="headerlink" title="基于封锁的并发控制"></a>基于封锁的并发控制</h2><h3 id="概述-4"><a href="#概述-4" class="headerlink" title="概述"></a>概述</h3><p><img src="/2023/11/26/database/image-20231119182722379.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119182748239.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119182825428.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119182902211.png" alt="image"></p>
<p>不满足</p>
<h3 id="考虑因素"><a href="#考虑因素" class="headerlink" title="考虑因素"></a>考虑因素</h3><h4 id="锁的类型"><a href="#锁的类型" class="headerlink" title="锁的类型"></a>锁的类型</h4><p><img src="/2023/11/26/database/image-20231119183008208.png" alt="image"></p>
<h4 id="封锁协议"><a href="#封锁协议" class="headerlink" title="封锁协议"></a>封锁协议</h4><p><img src="/2023/11/26/database/image-20231119183437646.png" alt="image"></p>
<h5 id="相容性矩阵"><a href="#相容性矩阵" class="headerlink" title="相容性矩阵"></a>相容性矩阵</h5><p><img src="/2023/11/26/database/image-20231119183052554.png" alt="image"></p>
<h5 id="加解锁时机"><a href="#加解锁时机" class="headerlink" title="加解锁时机"></a>加解锁时机</h5><p><img src="/2023/11/26/database/image-20231119183354649.png" alt="image"></p>
<h5 id="封锁粒度"><a href="#封锁粒度" class="headerlink" title="封锁粒度"></a>封锁粒度</h5><p><img src="/2023/11/26/database/image-20231119183424841.png" alt="image"></p>
<h3 id="两段封锁协议"><a href="#两段封锁协议" class="headerlink" title="两段封锁协议"></a>两段封锁协议</h3><p>两段封锁协议是一种基于锁的并发控制方法。</p>
<p><img src="/2023/11/26/database/image-20231119183734987.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119183809930.png" alt="image"></p>
<p>满足</p>
<p><img src="/2023/11/26/database/image-20231119190000255.png" alt="image"></p>
<p>注意这个两端锁与前面那个只用锁的差距。两段锁把B加锁也移到前面了，所以可以保证冲突可串行性。</p>
<p><img src="/2023/11/26/database/image-20231119184848690.png" alt="image"></p>
<p>读nm，不读再见</p>
<p>可以看到，图中确实是满足两段锁协议要求的，加锁段里确实没有解锁段。消除死锁的方式应该就是按照一定顺序获取锁。</p>
<p><img src="/2023/11/26/database/image-20231119185021920.png" alt="image"></p>
<h2 id="基于时间戳的并发控制方法"><a href="#基于时间戳的并发控制方法" class="headerlink" title="基于时间戳的并发控制方法"></a>基于时间戳的并发控制方法</h2><h3 id="概述-5"><a href="#概述-5" class="headerlink" title="概述"></a>概述</h3><p><img src="/2023/11/26/database/image-20231119185219724.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119185313831.png" alt="image"></p>
<h3 id="简单的调度规则"><a href="#简单的调度规则" class="headerlink" title="简单的调度规则"></a>简单的调度规则</h3><h4 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h4><p><img src="/2023/11/26/database/image-20231119185426363.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119185809229.png" alt="image"></p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p><img src="/2023/11/26/database/image-20231119190647080.png" alt="image"></p>
<p>真没看懂为什么要撤回T2和T3</p>
<p><img src="/2023/11/26/database/image-20231119190713620.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119190722939.png" alt="image"></p>
<h4 id="冲突是否可串行"><a href="#冲突是否可串行" class="headerlink" title="冲突是否可串行"></a>冲突是否可串行</h4><p><img src="/2023/11/26/database/image-20231119190732156.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119190753184.png" alt="image"></p>
<h3 id="另一种调度规则"><a href="#另一种调度规则" class="headerlink" title="另一种调度规则"></a>另一种调度规则</h3><h4 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h4><p><img src="/2023/11/26/database/image-20231119190857194.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119190912445.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119190934097.png" alt="image"></p>
<p>也就是说U没有提交，所以T要更新的反而也丢了，变得更加过时（）</p>
<h4 id="规则-1"><a href="#规则-1" class="headerlink" title="规则"></a>规则</h4><p><img src="/2023/11/26/database/image-20231119191015552.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191045159.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191054856.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191104080.png" alt="image"></p>
<h2 id="基于有效性确认的并发控制"><a href="#基于有效性确认的并发控制" class="headerlink" title="基于有效性确认的并发控制"></a>基于有效性确认的并发控制</h2><p><img src="/2023/11/26/database/image-20231119191209359.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191232017.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191239423.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191248063.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191258181.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191307118.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119191316150.png" alt="image"></p>
<h1 id="第十二章-数据库事务恢复技术"><a href="#第十二章-数据库事务恢复技术" class="headerlink" title="第十二章  数据库事务恢复技术"></a>第十二章  数据库事务恢复技术</h1><h2 id="故障类型与影响"><a href="#故障类型与影响" class="headerlink" title="故障类型与影响"></a>故障类型与影响</h2><p><img src="/2023/11/26/database/image-20231119192002472.png" alt="image"></p>
<h2 id="恢复基本思路"><a href="#恢复基本思路" class="headerlink" title="恢复基本思路"></a>恢复基本思路</h2><p><img src="/2023/11/26/database/image-20231119192440160.png" alt="image"></p>
<h3 id="事务故障"><a href="#事务故障" class="headerlink" title="事务故障"></a>事务故障</h3><p><img src="/2023/11/26/database/image-20231119192026862.png" alt="image"></p>
<h3 id="系统故障"><a href="#系统故障" class="headerlink" title="系统故障"></a>系统故障</h3><p><img src="/2023/11/26/database/image-20231119192052667.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119192116624.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119192149089.png" alt="image"></p>
<h3 id="介质故障"><a href="#介质故障" class="headerlink" title="介质故障"></a>介质故障</h3><p><img src="/2023/11/26/database/image-20231119192243058.png" alt="image"></p>
<p>冗余阵列</p>
<p><img src="/2023/11/26/database/image-20231119192428709.png" alt="image"></p>
<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><h3 id="是什么-1"><a href="#是什么-1" class="headerlink" title="是什么"></a>是什么</h3><p><img src="/2023/11/26/database/image-20231119192539099.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119192914170.png" alt="image"></p>
<p>此时应该上层已经确保了事务的调度是冲突可串行化的，所以这里不用考虑会不会脏读问题。</p>
<p><img src="/2023/11/26/database/image-20231119193119271.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119193150204.png" alt="image"></p>
<h3 id="Undo型日志"><a href="#Undo型日志" class="headerlink" title="Undo型日志"></a>Undo型日志</h3><h4 id="记录规则"><a href="#记录规则" class="headerlink" title="记录规则"></a>记录规则</h4><p>这对应的应该是Steal</p>
<p><img src="/2023/11/26/database/image-20231119193328297.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119193341453.png" alt="image"></p>
<h4 id="恢复步骤"><a href="#恢复步骤" class="headerlink" title="恢复步骤"></a>恢复步骤</h4><p><img src="/2023/11/26/database/image-20231119195347779.png" alt="image"></p>
<h4 id="检查点"><a href="#检查点" class="headerlink" title="检查点"></a>检查点</h4><p><img src="/2023/11/26/database/image-20231119195518473.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119195544728.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119195556555.png" alt="image"></p>
<h3 id="Redo型日志"><a href="#Redo型日志" class="headerlink" title="Redo型日志"></a>Redo型日志</h3><h4 id="记录规则-1"><a href="#记录规则-1" class="headerlink" title="记录规则"></a>记录规则</h4><p>这对应的应该是No Steal</p>
<p><img src="/2023/11/26/database/image-20231119195713826.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119195819326.png" alt="image"></p>
<h4 id="恢复步骤-1"><a href="#恢复步骤-1" class="headerlink" title="恢复步骤"></a>恢复步骤</h4><p><img src="/2023/11/26/database/image-20231119195930925.png" alt="image"></p>
<h4 id="检查点-1"><a href="#检查点-1" class="headerlink" title="检查点"></a>检查点</h4><p><img src="/2023/11/26/database/image-20231119200045529.png" alt="image"></p>
<h3 id="结合型日志"><a href="#结合型日志" class="headerlink" title="结合型日志"></a>结合型日志</h3><p><img src="/2023/11/26/database/image-20231119200151170.png" alt="image"></p>
<h4 id="记录规则-2"><a href="#记录规则-2" class="headerlink" title="记录规则"></a>记录规则</h4><p><img src="/2023/11/26/database/image-20231119200249519.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119200303286.png" alt="image"></p>
<h4 id="恢复步骤-2"><a href="#恢复步骤-2" class="headerlink" title="恢复步骤"></a>恢复步骤</h4><p><img src="/2023/11/26/database/image-20231119200359441.png" alt="image"></p>
<p>感觉得先undo再redo？</p>
<p><img src="/2023/11/26/database/image-20231119200437439.png" alt="image"></p>
<p><img src="/2023/11/26/database/image-20231119200447605.png" alt="image"></p>

        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2023/11/26/cryptography/">密码学基础</a>
            
            
            <a class="next" rel="next" href="/2023/11/18/compilation_principle/">编译原理</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© 修年 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>